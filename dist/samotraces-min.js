!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.Samotraces=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){var d=a("./Widget.js"),e=a("jquery"),f=a("d3"),g=function(a,b,c){"use strict";d.call(this,a),this.add_class("Widget-TraceModel"),this.model=b,this.model.on("Model:Draw_obsel",this.draw.bind(this)),this.init_DOM();var e=this;this.model.on("Model:listeType",function(a){e.data=a.data,e.draw()});var f=function(a){return a instanceof Function?a.bind(e):a},g=0,h=16;this.options={},this.options.y_Img=f(c.x||function(){return g+=16}),this.options.y_text=f(c.x||function(){return h+=16}),this.stylesheet=c||{},this.data=b.list_Types_Obsles,this.draw()};g.prototype={init_DOM:function(){"use strict";var a=f.select(this.element);this.div_elmt=f.select(this.element),this.svg=a.append("svg"),this.x=16,this.translate_offset=0;var b=(f.time.scale().domain([new Date(2014,4,1),new Date(2014,4,15)-1]).range([0,this.element.clientWidth]),{top:200,right:40,bottom:200,left:40});500-b.top-b.bottom;this.svg_selected_obsel=a.append("line").attr("x1","0").attr("y1","0%").attr("x2","0").attr("y2","100%").attr("stroke-width","1px").attr("stroke","black").attr("opacity","0.3").attr("transform","translate(0,0)").style("display","none")},d3Obsels:function(){"use strict";return this.svg_gp.selectAll("circle,image,rect").data(this.data,function(a){return a.id})},d3Obselstext:function(){"use strict";return this.svg_text.selectAll("circle,image,rect").data(this.data,function(a){return a.id})},draw:function(a){"use strict";if(0!==this.data.length){var b=this.svg.selectAll("circle,image,rect").data(this.data,function(a){return a.id}).enter().append("image"),c=this,d=(b.attr("class","Samotraces-obsel").attr("y",this.options.y_Img).attr("x",17).attr("width",function(){return c.getValueAttributStyle(this.__data__.type,"width")}).attr("height",function(){return c.getValueAttributStyle(this.__data__.type,"height")}).attr("xlink:href",function(){return c.getValueAttributStyle(this.__data__.type,"icon")}),this.svg.selectAll("text").data(this.data).enter().append("text"));d.attr("x","35").attr("y",this.options.y_text).text(function(a){return a.type}).attr("font-family","sans-serif").attr("font-size","15px");e("image",this.element).each(function(a,b){e.data(b,{"Samotraces-type":"obsel","Samotraces-data":f.select(b).datum()})})}},refresh_x:function(){"use strict";this.scale_x=this.element.clientWidth/this.window.get_width(),this.translate_offset=0,this.svg_gp.attr("transform","translate(0,0)"),this.d3Obsels().attr("x",this.options.x).attr("y",this.options.y)}},b.exports=g},{"./Widget.js":18,d3:"d3",jquery:"jquery"}],2:[function(a,b,c){var d=a("./Widget.js"),e=function(a,b){"use strict";d.call(this,a),this.trace=b,this.init_DOM()};e.prototype={init_DOM:function(){"use strict";var a=document.createElement("p"),b=document.createTextNode("Import a trace: ");a.appendChild(b),this.input_element=document.createElement("input"),this.input_element.setAttribute("type","file"),this.input_element.setAttribute("name","csv-file[]"),this.input_element.setAttribute("multiple","true"),a.appendChild(this.input_element),this.form_element=document.createElement("form"),this.input_element.addEventListener("change",this.on_change.bind(this)),this.form_element.appendChild(a),this.element.appendChild(this.form_element);var c=document.createElement("p"),d=document.createElement("a");d.href="",d.innerHTML="toggle console",c.appendChild(d),d.addEventListener("click",this.on_toggle.bind(this)),this.element.appendChild(c),this.display_element=document.createElement("div"),this.display_element.style.display="none",this.element.appendChild(this.display_element)},on_change:function(a){"use strict";for(var b,c,d,e=a.target.files,f=0;d=e[f];f++){b=document.createElement("h2"),b.appendChild(document.createTextNode(d.name)),this.display_element.appendChild(b),c=document.createElement("pre");var g=new FileReader;g.onload=function(a,b,c){return function(d){b(d.target.result,c),a.appendChild(document.createTextNode(d.target.result))}}(c,this.parse_csv,this.trace),g.readAsText(d),this.display_element.appendChild(c),this.trace.trigger("beforLoadFile")}},on_toggle:function(a){"use strict";return a.preventDefault(),"none"===this.display_element.style.display?this.display_element.style.display="block":this.display_element.style.display="none",!1},parse_csv:function(a,b){"use strict";function c(a,b){b=b||",";for(var c=new RegExp("(\\"+b+'|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\'+b+"\\r\\n]*))","gi"),d=[[]],e=null;e=c.exec(a);){var f=e[1];if(f.length&&f!==b&&d.push([]),e[2])var g=e[2].replace(new RegExp('""',"g"),'"');else var g=e[3];d[d.length-1].push(g)}return d}var d=a[a.search("[,;	]")],e=c(a,d);e.pop(),e.map(function(a,c){var d={};d.begin=a.shift(),d.type=a.shift(),d.attributes={};for(var f=0;f<(a.length-1)/2;f++)""!==a[2*f]&&(d.attributes[a[2*f]]=a[2*f+1]);0===c&&b.trigger("firstObselLocal",d),c===e.length-1&&b.trigger("LastObselLocal",d),b.create_obsel(d)})}},b.exports=e},{"./Widget.js":18}],3:[function(a,b,c){var d=a("./Widget.js"),e=function(a,b){d.call(this,a),this.add_class("Widget-ReadableTimeForm"),this.window=b,this.window.on("tw:update",this.refresh.bind(this)),this.window.on("tw:translate",this.refresh.bind(this)),this.init_DOM(),this.refresh()};e.prototype={init_DOM:function(){var a=document.createElement("p"),b=document.createTextNode("FROM: ");a.appendChild(b),this.year_element=document.createElement("input"),this.year_element.setAttribute("type","text"),this.year_element.setAttribute("name","year"),this.year_element.setAttribute("size",4),this.year_element.setAttribute("value",""),a.appendChild(this.year_element),a.appendChild(document.createTextNode("/")),this.month_element=document.createElement("input"),this.month_element.setAttribute("type","text"),this.month_element.setAttribute("name","month"),this.month_element.setAttribute("size",2),this.month_element.setAttribute("value",""),a.appendChild(this.month_element),a.appendChild(document.createTextNode("/")),this.day_element=document.createElement("input"),this.day_element.setAttribute("type","text"),this.day_element.setAttribute("name","day"),this.day_element.setAttribute("size",2),this.day_element.setAttribute("value",""),a.appendChild(this.day_element),a.appendChild(document.createTextNode(" - ")),this.hour_element=document.createElement("input"),this.hour_element.setAttribute("type","text"),this.hour_element.setAttribute("name","hour"),this.hour_element.setAttribute("size",2),this.hour_element.setAttribute("value",""),a.appendChild(this.hour_element),a.appendChild(document.createTextNode(":")),this.minute_element=document.createElement("input"),this.minute_element.setAttribute("type","text"),this.minute_element.setAttribute("name","minute"),this.minute_element.setAttribute("size",2),this.minute_element.setAttribute("value",""),a.appendChild(this.minute_element),a.appendChild(document.createTextNode(":")),this.second_element=document.createElement("input"),this.second_element.setAttribute("type","text"),this.second_element.setAttribute("name","second"),this.second_element.setAttribute("size",8),this.second_element.setAttribute("value",""),a.appendChild(this.second_element);var c=document.createTextNode("To: ");a.appendChild(c),this.year_element1=document.createElement("input"),this.year_element1.setAttribute("type","text"),this.year_element1.setAttribute("name","year"),this.year_element1.setAttribute("size",4),this.year_element1.setAttribute("value",""),a.appendChild(this.year_element1),a.appendChild(document.createTextNode("/")),this.month_element1=document.createElement("input"),this.month_element1.setAttribute("type","text"),this.month_element1.setAttribute("name","month"),this.month_element1.setAttribute("size",2),this.month_element1.setAttribute("value",""),a.appendChild(this.month_element1),a.appendChild(document.createTextNode("/")),this.day_element1=document.createElement("input"),this.day_element1.setAttribute("type","text"),this.day_element1.setAttribute("name","day"),this.day_element1.setAttribute("size",2),this.day_element1.setAttribute("value",""),a.appendChild(this.day_element1),a.appendChild(document.createTextNode(" - ")),this.hour_element1=document.createElement("input"),this.hour_element1.setAttribute("type","text"),this.hour_element1.setAttribute("name","hour"),this.hour_element1.setAttribute("size",2),this.hour_element1.setAttribute("value",""),a.appendChild(this.hour_element1),a.appendChild(document.createTextNode(":")),this.minute_element1=document.createElement("input"),this.minute_element1.setAttribute("type","text"),this.minute_element1.setAttribute("name","minute"),this.minute_element1.setAttribute("size",2),this.minute_element1.setAttribute("value",""),a.appendChild(this.minute_element1),a.appendChild(document.createTextNode(":")),this.second_element1=document.createElement("input"),this.second_element1.setAttribute("type","text"),this.second_element1.setAttribute("name","second"),this.second_element1.setAttribute("size",8),this.second_element1.setAttribute("value",""),a.appendChild(this.second_element1);var d=document.createElement("input");d.setAttribute("type","submit"),d.setAttribute("value","Update time"),a.appendChild(d),this.form_element=document.createElement("form"),this.form_element.addEventListener("submit",this.build_callback("submit")),this.form_element.appendChild(a),this.element.appendChild(this.form_element)},refresh:function(){timestart=this.window.start,timeEnd=this.window.end;var a=new Date;a.setTime(timestart),this.year_element.value=a.getFullYear(),this.month_element.value=a.getMonth()+1,this.day_element.value=a.getDate(),this.hour_element.value=a.getHours(),this.minute_element.value=a.getMinutes(),this.second_element.value=a.getSeconds()+a.getMilliseconds()/1e3;var b=new Date;b.setTime(timeEnd),this.year_element1.value=b.getFullYear(),this.month_element1.value=b.getMonth()+1,this.day_element1.value=b.getDate(),this.hour_element1.value=b.getHours(),this.minute_element1.value=b.getMinutes(),this.second_element1.value=b.getSeconds()+b.getMilliseconds()/1e3},build_callback:function(a){var b=this.window,c=this;switch(a){case"submit":return function(a){a.preventDefault();var d=new Date;d.setFullYear(c.year_element.value),d.setMonth(c.month_element.value-1),d.setDate(c.day_element.value),d.setHours(c.hour_element.value),d.setMinutes(c.minute_element.value),d.setSeconds(c.second_element.value);var e=new Date;return e.setFullYear(c.year_element1.value),e.setMonth(c.month_element1.value-1),e.setDate(c.day_element1.value),e.setHours(c.hour_element1.value),e.setMinutes(c.minute_element1.value),e.setSeconds(c.second_element1.value),b.set_start(d.getTime()),b.set_end(e.getTime()),!1};default:return function(){}}}},b.exports=e},{"./Widget.js":18}],4:[function(a,b,c){var d=a("jquery"),e=a("./Widget.js"),f=a("../../core/EventHandler.js"),g=function(a,b,c){e.call(this,a),f.call(this,c),this.add_class("Widget-ListBases"),this.ktbs=b,b.on("ktbs:update",this.refresh.bind(this)),this.init_DOM()};g.prototype={init_DOM:function(){this.datalist_element=document.createElement("ul"),this.element.appendChild(this.datalist_element),this.add_button=document.createElement("button"),d(this.add_button).append("New base"),this.element.appendChild(this.add_button),d(this.add_button).click(this.open_form.bind(this))},open_form:function(){this.add_button.disabled=!0,this.form={},this.form.input_id=document.createElement("input"),this.form.input_id.size=20,this.form.text1=document.createTextNode(" Base ID: "),this.form.input_label=document.createElement("input"),this.form.input_label.size=20,this.form.text2=document.createTextNode(" label: "),this.form.button=document.createElement("button"),d(this.form.button).append("create"),d(this.element).append(this.form.text1),d(this.element).append(this.form.input_id),d(this.element).append(this.form.text2),d(this.element).append(this.form.input_label),d(this.element).append(this.form.button),d(this.form.button).click(this.create_base.bind(this))},create_base:function(a){""!==d(this.form.input_id).val()?(console.log("Creating a new base..."),this.ktbs.create_base(d(this.form.input_id).val(),d(this.form.input_label).val())):console.log("Empty base name... No base created");for(var b in this.form)this.form.hasOwnProperty(b)&&d(this.form[b]).remove();this.add_button.disabled=!1},refresh:function(){this.datalist_element.innerHTML="";var a;this.ktbs.list_bases().forEach(function(b){a=document.createElement("li"),li_link=document.createElement("button"),li_link.setAttribute("class","base"),li_link.appendChild(document.createTextNode(b)),a.appendChild(li_link),a.addEventListener("click",function(){this.trigger("ui:click:base",b)}.bind(this)),this.datalist_element.appendChild(a)},this),this.trigger("ListBase")}},b.exports=g},{"../../core/EventHandler.js":22,"./Widget.js":18,jquery:"jquery"}],5:[function(a,b,c){var d=a("jquery"),e=a("./Widget.js"),f=a("../../core/EventHandler.js"),g=function(a,b,c){e.call(this,a),f.call(this,c),this.add_class("Widget-ListTraces"),this.base=b,this.base.on("base:update",this.refresh.bind(this)),this.init_DOM()};g.prototype={init_DOM:function(){this.datalist_element=document.createElement("ul"),this.element.appendChild(this.datalist_element),this.add_button=document.createElement("button"),d(this.add_button).append("New Model"),this.element.appendChild(this.add_button),d(this.add_button).click(this.open_form.bind(this))},open_form:function(){this.add_button.disabled=!0,this.form={},this.form.input_id=document.createElement("input"),this.form.input_id.size=20,this.form.text1=document.createTextNode(" Model ID: "),this.form.button=document.createElement("button"),d(this.form.button).append("create"),d(this.element).append(this.form.text1),d(this.element).append(this.form.input_id),d(this.element).append(this.form.button),d(this.form.button).click(this.create_trace.bind(this))},create_trace:function(a){""!==d(this.form.input_id).val()?(console.log("Creating a new trace..."),this.base.create_model(d(this.form.input_id).val())):console.log("Empty trace name... No trace created");for(var b in this.form)d(this.form[b]).remove();this.add_button.disabled=!1},remove_base:function(){this.base.remove()},refresh:function(){this.datalist_element.innerHTML="";var a;this.base.list_traces().forEach(function(b){"TraceModel"==b["@type"]&&(a=document.createElement("li"),li_link=document.createElement("button"),li_link.setAttribute("class","model"),li_link.appendChild(document.createTextNode(b["@id"])),a.appendChild(li_link),a.addEventListener("click",function(){this.trigger("ui:click:trace",b["@id"])}.bind(this)),this.datalist_element.appendChild(a))},this),this.trigger("ListModel")},select:function(){}},b.exports=g},{"../../core/EventHandler.js":22,"./Widget.js":18,jquery:"jquery"}],6:[function(a,b,c){var d=a("jquery"),e=a("./Widget.js"),f=a("../../core/EventHandler.js"),g=function(a,b,c){e.call(this,a),f.call(this,c),this.add_class("Widget-ListTraces"),this.base=b,this.base.on("base:update",this.refresh.bind(this)),this.init_DOM()};g.prototype={init_DOM:function(){this.datalist_element=document.createElement("ul"),this.element.appendChild(this.datalist_element),this.add_button=document.createElement("button"),d(this.add_button).append("New trace"),this.element.appendChild(this.add_button),d(this.add_button).click(this.open_form.bind(this))},open_form:function(){this.add_button.disabled=!0,this.form={},this.form.input_id=document.createElement("input"),this.form.input_id.size=20,this.form.text1=document.createTextNode(" Trace ID: "),this.form.input_label=document.createElement("input"),this.form.input_label.size=20,this.form.text2=document.createTextNode(" label: "),this.form.input_model=document.createElement("input"),this.form.input_model.size=20,this.form.text3=document.createTextNode(" MODEL URI: "),this.form.button=document.createElement("button"),d(this.form.button).append("create"),d(this.element).append(this.form.text1),d(this.element).append(this.form.input_id),d(this.element).append(this.form.text2),d(this.element).append(this.form.input_label),d(this.element).append(this.form.text3),d(this.element).append(this.form.input_model),d(this.element).append(this.form.button),d(this.form.button).click(this.create_trace.bind(this))},create_trace:function(a){""!==d(this.form.input_id).val()?(console.log("Creating a new trace..."),this.base.create_stored_trace(d(this.form.input_id).val(),d(this.form.input_model).val(),null,null,d(this.form.input_label).val())):console.log("Empty trace name... No trace created");for(var b in this.form)this.form.hasOwnProperty(b)&&d(this.form[b]).remove();this.add_button.disabled=!1},remove_base:function(){this.base.remove()},refresh:function(){this.datalist_element.innerHTML="";var a;this.base.list_traces().forEach(function(b){"StoredTrace"==b["@type"]&&(a=document.createElement("li"),li_link=document.createElement("button"),li_link.setAttribute("class","trace"),li_link.appendChild(document.createTextNode(b["@id"])),a.appendChild(li_link),a.addEventListener("click",function(){this.trigger("ui:click:trace",b["@id"])}.bind(this)),this.datalist_element.appendChild(a))},this),this.trigger("ListTrace")},select:function(){}},b.exports=g},{"../../core/EventHandler.js":22,"./Widget.js":18,jquery:"jquery"}],7:[function(a,b,c){var d=a("./Widget.js"),e=function(a,b){d.call(this,a),this.add_class("Widget-ObselInspector"),this.obsel=b,this.obsel.on("selection:add",this.inspect.bind(this)),this.obsel.on("selection:empty",this.close.bind(this)),this.obsel.on("selection:remove",this.close.bind(this)),this.init_DOM()};e.prototype={init_DOM:function(){this.close_element=document.createElement("span");var a=document.createElement("img");a.setAttribute("src","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAFPSURBVDiNlZOxTgJREEXPfUuPEmyMrQSLJaHWhCiltYX/oZ2VscLKr6CgpgOMRn/ARRAtiTYYsVd2LFjIstklcZqXzMy5M5mZpxEUf+HC4ARoO7jeM3sjxV6kUjjPPRQ0c9DQMzQMzmN5nyEc+WZBHA4k30EPKC58ghv1YQzsJIqtiKTBkX04wW1Kt0UHvb5U6UuVDBigrSGUQngw2EpGDb6jVjeSMcFEsC8zI5B8D7ppImkmmMyg7psFDsA3C2ZQF0z+AwPIzJbBaFh3wGYGPw2hFt+Qi0c98JTwJao7D7y4b5k8kKo2n0M+S8Agb9AdSNUVgQjuAIUsOGYFg85CRE9QdvCYAU+jN20mXwYHzoOzNFgwCaEWQi1jOwXBhfrwDmwn4fiq1tzJ2Ala62BYeydNjaD4M/+Npwb3Obgsm72mtMxQ2g3nuceCVg6u/gBs54alonwdWQAAAABJRU5ErkJggg=="),this.close_element.appendChild(a),this.element.appendChild(this.close_element),this.datalist_element=document.createElement("ul"),this.element.appendChild(this.datalist_element),this.element.style.display="none",this.close_element.addEventListener("click",this.onCloseAction.bind(this))},inspect:function(a){var b=a.data;this.datalist_element.innerHTML="";var c=(b.attributes,document.createElement("li"));c.appendChild(document.createTextNode("id: "+b.get_id())),this.datalist_element.appendChild(c),c=document.createElement("li"),c.appendChild(document.createTextNode("type: "+b.get_type())),this.datalist_element.appendChild(c),c=document.createElement("li"),c.appendChild(document.createTextNode("begin: "+b.get_begin())),this.datalist_element.appendChild(c),c=document.createElement("li"),c.appendChild(document.createTextNode("end: "+b.get_end())),this.datalist_element.appendChild(c);for(var d in b.attributes)b.attributes.hasOwnProperty(d)&&(c=document.createElement("li"),c.appendChild(document.createTextNode(d+": "+b.attributes[d])),this.datalist_element.appendChild(c));this.element.style.display="block"},close:function(){this.element.style.display="none"},onCloseAction:function(){this.obsel.unselect()}},b.exports=e},{"./Widget.js":18}],8:[function(a,b,c){var d=a("./Widget.js"),e=function(a,b){d.call(this,a),this.add_class("Widget-ObselInspectorType"),this.obsel=b,this.obsel.on("selection:add",this.inspect.bind(this)),this.obsel.on("selection:empty",this.close.bind(this)),this.obsel.on("selection:remove",this.close.bind(this)),this.init_DOM()};e.prototype={init_DOM:function(){this.close_element=document.createElement("span");var a=document.createElement("img");a.setAttribute("src","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAFPSURBVDiNlZOxTgJREEXPfUuPEmyMrQSLJaHWhCiltYX/oZ2VscLKr6CgpgOMRn/ARRAtiTYYsVd2LFjIstklcZqXzMy5M5mZpxEUf+HC4ARoO7jeM3sjxV6kUjjPPRQ0c9DQMzQMzmN5nyEc+WZBHA4k30EPKC58ghv1YQzsJIqtiKTBkX04wW1Kt0UHvb5U6UuVDBigrSGUQngw2EpGDb6jVjeSMcFEsC8zI5B8D7ppImkmmMyg7psFDsA3C2ZQF0z+AwPIzJbBaFh3wGYGPw2hFt+Qi0c98JTwJao7D7y4b5k8kKo2n0M+S8Agb9AdSNUVgQjuAIUsOGYFg85CRE9QdvCYAU+jN20mXwYHzoOzNFgwCaEWQi1jOwXBhfrwDmwn4fiq1tzJ2Ala62BYeydNjaD4M/+Npwb3Obgsm72mtMxQ2g3nuceCVg6u/gBs54alonwdWQAAAABJRU5ErkJggg=="),this.close_element.appendChild(a),this.element.appendChild(this.close_element),this.datalist_element=document.createElement("ul"),this.element.appendChild(this.datalist_element),this.element.style.display="none",this.close_element.addEventListener("click",this.onCloseAction.bind(this))},inspect:function(a){var b=a.data;this.datalist_element.innerHTML="";b.attributes;li_element=document.createElement("li"),li_element.appendChild(document.createTextNode("type: "+b.type)),this.datalist_element.appendChild(li_element),li_element=document.createElement("li"),li_element.appendChild(document.createTextNode("Attribut: "));for(var c in b.attributes)for(var d in b.attributes[c])"@id"==d?(ul_element_A=document.createElement("ul"),li_element_A=document.createElement("li"),li_text=b.attributes[c][d]+" : "):"label"==d&&(li_element_A.appendChild(document.createTextNode(li_text+b.attributes[c][d])),ul_element_A.appendChild(li_element_A),li_element.appendChild(ul_element_A));this.datalist_element.appendChild(li_element),this.element.style.display="block"},close:function(){this.element.style.display="none"},onCloseAction:function(){this.obsel.unselect()}},b.exports=e},{"./Widget.js":18}],9:[function(a,b,c){var d=a("./Widget.js"),e=function(a,b){d.call(this,a),this.add_class("Widget-ReadableTimeForm"),this.timer=b,this.timer.on("timer:update",this.refresh.bind(this)),this.timer.on("timer:play:update",this.refresh.bind(this)),this.init_DOM(),this.refresh({data:this.timer.time})};e.prototype={init_DOM:function(){var a=document.createElement("p"),b=document.createTextNode("Current time: ");a.appendChild(b),this.year_element=document.createElement("input"),this.year_element.setAttribute("type","text"),this.year_element.setAttribute("name","year"),this.year_element.setAttribute("size",4),this.year_element.setAttribute("value",""),a.appendChild(this.year_element),a.appendChild(document.createTextNode("/")),this.month_element=document.createElement("input"),this.month_element.setAttribute("type","text"),this.month_element.setAttribute("name","month"),this.month_element.setAttribute("size",2),this.month_element.setAttribute("value",""),a.appendChild(this.month_element),a.appendChild(document.createTextNode("/")),this.day_element=document.createElement("input"),this.day_element.setAttribute("type","text"),this.day_element.setAttribute("name","day"),this.day_element.setAttribute("size",2),this.day_element.setAttribute("value",""),a.appendChild(this.day_element),a.appendChild(document.createTextNode(" - ")),this.hour_element=document.createElement("input"),this.hour_element.setAttribute("type","text"),this.hour_element.setAttribute("name","hour"),this.hour_element.setAttribute("size",2),this.hour_element.setAttribute("value",""),a.appendChild(this.hour_element),a.appendChild(document.createTextNode(":")),this.minute_element=document.createElement("input"),this.minute_element.setAttribute("type","text"),this.minute_element.setAttribute("name","minute"),this.minute_element.setAttribute("size",2),this.minute_element.setAttribute("value",""),a.appendChild(this.minute_element),a.appendChild(document.createTextNode(":")),this.second_element=document.createElement("input"),this.second_element.setAttribute("type","text"),this.second_element.setAttribute("name","second"),this.second_element.setAttribute("size",8),this.second_element.setAttribute("value",""),a.appendChild(this.second_element);var c=document.createElement("input");c.setAttribute("type","submit"),c.setAttribute("value","Update time"),a.appendChild(c),this.form_element=document.createElement("form"),this.form_element.addEventListener("submit",this.build_callback("submit")),this.form_element.appendChild(a),this.element.appendChild(this.form_element)},refresh:function(a){var b=a.data,c=new Date;c.setTime(b),this.year_element.value=c.getFullYear(),this.month_element.value=c.getMonth()+1,this.day_element.value=c.getDate(),this.hour_element.value=c.getHours(),this.minute_element.value=c.getMinutes(),this.second_element.value=c.getSeconds()+c.getMilliseconds()/1e3},build_callback:function(a){var b=this.timer,c=this;switch(a){case"submit":return function(a){a.preventDefault();var d=new Date;return d.setFullYear(c.year_element.value),d.setMonth(c.month_element.value-1),d.setDate(c.day_element.value),d.setHours(c.hour_element.value),d.setMinutes(c.minute_element.value),d.setSeconds(c.second_element.value),b.set(d.getTime()),!1};default:return function(){}}}},b.exports=e},{"./Widget.js":18}],10:[function(a,b,c){var d=a("./Widget.js"),e=function(a,b){d.call(this,a),this.timer=b,this.timer.on("timer:update",this.refresh.bind(this)),this.timer.on("timer:play:update",this.refresh.bind(this)),this.init_DOM(),this.refresh({data:this.timer.time})};e.prototype={init_DOM:function(){var a=document.createElement("p"),b=document.createTextNode("Current time: ");a.appendChild(b),this.input_element=document.createElement("input"),this.input_element.setAttribute("type","text"),this.input_element.setAttribute("name","time"),this.input_element.setAttribute("size",15),this.input_element.setAttribute("value",this.timer.time),a.appendChild(this.input_element);var c=document.createElement("input");c.setAttribute("type","submit"),c.setAttribute("value","Update time"),a.appendChild(c),this.form_element=document.createElement("form"),this.form_element.addEventListener("submit",this.build_callback("submit")),this.form_element.appendChild(a),this.element.appendChild(this.form_element)},refresh:function(a){this.input_element.value=a.data},build_callback:function(a){var b=this.timer,c=this.input_element;switch(a){case"submit":return function(a){return a.preventDefault(),b.set(c.value),!1};default:return function(){}}}},b.exports=e},{"./Widget.js":18}],11:[function(a,b,c){var d=a("./Widget.js"),e=a("jquery"),f=function(a,b,c){d.call(this,a),this.add_class("Widget-TimeSlider"),e(window).resize(this.draw.bind(this)),this.timer=c,this.timer.on("timer:update",this.draw.bind(this)),this.timer.on("timer:play:update",this.refresh.bind(this)),this.time_window=b,this.time_window.on("tw:update",this.draw.bind(this)),this.slider_offset=0,this.init_DOM(),this.draw()};f.prototype={init_DOM:function(){this.slider_element=document.createElement("div"),this.element.appendChild(this.slider_element);var a=this;this.add_behaviour("changeTimeOnDrag",this.slider_element,{onUpCallback:function(b){var c=a.timer.time+b*a.time_window.get_width()/a.element.clientWidth;a.timer.set(c)},onMoveCallback:function(b){var b=a.slider_offset+b;a.slider_element.setAttribute("style","left: "+b+"px;")}})},draw:function(){this.slider_offset=(this.timer.time-this.time_window.start)*this.element.clientWidth/this.time_window.get_width(),this.slider_element.setAttribute("style","left:"+this.slider_offset+"px; display: block;")}},b.exports=f},{"./Widget.js":18,jquery:"jquery"}],12:[function(a,b,c){var d=a("./Widget.js"),e=a("jquery"),f=a("d3"),g=function(a,b,c,f){f=f||{},d.call(this,a),this.add_class("Widget-TraceDisplayIcons"),e(window).resize(this.refresh_x.bind(this)),this.trace=b,this.trace.on("trace:update",this.draw.bind(this)),this.trace.on("trace:create_obsel",this.draw.bind(this)),this.trace.on("trace:remove_obsel",this.draw.bind(this)),this.trace.on("trace:edit_obsel",this.obsel_redraw.bind(this)),this.window=c,this.window.on("tw:update",this.refresh_x.bind(this)),this.window.on("tw:translate",this.translate_x.bind(this)),this.init_DOM(),this.data=this.trace.obsel_list;var g=this,h=function(a){return a instanceof Function?a.bind(g):a};this.options={},this.options.x=h(f.x||function(a){return this.calculate_x(a.get_begin())-8}),this.stylesheet=f,this.draw()};g.prototype={init_DOM:function(){var a=f.select(this.element);this.svg=a.append("svg"),"undefined"!=typeof this.window.timer&&this.svg.append("line").attr("x1","50%").attr("y1","0%").attr("x2","50%").attr("y2","100%").attr("stroke-width","1px").attr("stroke","red").attr("opacity","0.3"),this.scale_x=this.element.clientWidth/this.window.get_width(),this.translate_offset=0,this.svg_gp=this.svg.append("g").attr("transform","translate(0,0)"),this.svg_selected_obsel=this.svg.append("line").attr("x1","0").attr("y1","0%").attr("x2","0").attr("y2","100%").attr("stroke-width","1px").attr("stroke","black").attr("opacity","0.3").attr("transform","translate(0,0)").style("display","none");var b=this;this.add_behaviour("changeTimeOnDrag",this.element,{onUpCallback:function(a){var c=-a*b.window.get_width()/b.element.clientWidth;b.svg_gp.attr("transform","translate("+-b.translate_offset+",0)"),b.window.translate(c)},onMoveCallback:function(a){b.svg_gp.attr("transform","translate("+(a-b.translate_offset)+",0)")}}),this.add_behaviour("zommOnScroll",this.element,{timeWindow:this.window})},calculate_x:function(a){var b=(a-this.window.start)*this.scale_x+this.translate_offset;return b},translate_x:function(a){var b=a.data;this.translate_offset+=b*this.scale_x,this.svg_gp.attr("transform","translate("+-this.translate_offset+",0)")},refresh_x:function(){this.scale_x=this.element.clientWidth/this.window.get_width(),this.translate_offset=0,this.svg_gp.attr("transform","translate(0,0)");var a=this;this.d3Obsels().attr("x",this.options.x).attr("y",function(){return a.getValueAttributStyle(this.__data__.type,"y")})},draw:function(a){if(a)switch(a.type){case"trace:update":this.data=this.trace.list_obsels();break;default:this.data=this.trace.obsel_list}var b=this;this.d3Obsels().exit().remove(),this.d3Obsels().enter().append("image").attr("class","Samotraces-obsel").attr("x",this.options.x).attr("y",function(){return b.getValueAttributStyle(this.__data__.type,"y")}).attr("width",function(){return b.getValueAttributStyle(this.__data__.type,"width")}).attr("height",function(){return b.getValueAttributStyle(this.__data__.type,"height")}).attr("xlink:href",function(){return b.getValueAttributStyle(this.__data__.type,"icon")}),e("image",this.element).each(function(a,b){e.data(b,{"Samotraces-type":"obsel","Samotraces-data":f.select(b).datum()})})},obsel_redraw:function(a){var b=a.data,c=this;this.d3Obsels().filter(function(a){return a.get_id()==b.get_id()}).datum(b).attr("x",this.options.x).attr("y",function(){return c.getValueAttributStyle(this.__data__.type,"y")}).attr("width",function(){return c.getValueAttributStyle(this.__data__.type,"width")}).attr("height",function(){return c.getValueAttributStyle(this.__data__.type,"height")}).attr("xlink:href",function(){return c.getValueAttributStyle(this.__data__.type,"icon")})},d3Obsels:function(){return this.svg_gp.selectAll("circle,image,rect").data(this.data,function(a){
return a.id})}},b.exports=g},{"./Widget.js":18,d3:"d3",jquery:"jquery"}],13:[function(a,b,c){var d=a("./Widget.js"),e=a("jquery"),f=a("d3"),g=function(a,b,c,f,g){"use strict";g=g||{},d.call(this,a),this.add_class("Widget-TraceDisplayIcons"),e(window).resize(this.refresh_x.bind(this)),this.trace=b,this.trace.on("trace:update",this.draw.bind(this)),this.trace.on("trace:create_obsel",this.draw.bind(this)),this.window=c,this.windowZoom=f,this.init_DOM(),this.data=this.trace.obsel_list;var h=this,i=function(a){return a instanceof Function?a.bind(h):a};this.options={},this.options.x=i(g.x||function(a){return this.calculate_x(a.get_begin())-8}),this.stylesheet=g,this.draw()};g.prototype={init_DOM:function(){"use strict";var a=f.select(this.element);this.svg=a.append("svg"),"undefined"!=typeof this.window.timer&&this.svg.append("line").attr("x1","50%").attr("y1","0%").attr("x2","50%").attr("y2","100%").attr("stroke-width","1px").attr("stroke","red").attr("opacity","0.3"),this.scale_x=this.element.clientWidth/this.window.get_width(),this.translate_offset=0;f.time.scale().domain([this.window.start,this.window.end]).range([0,this.element.clientWidth]);this.svg_gp=this.svg.append("g").attr("transform","translate(0,0)"),this.svg_selected_obsel=this.svg.append("line").attr("x1","0").attr("y1","0%").attr("x2","0").attr("y2","100%").attr("stroke-width","1px").attr("stroke","black").attr("opacity","0.3").attr("transform","translate(0,0)").style("display","none"),this.addbrush()},d3Obsels:function(){"use strict";return this.svg_gp.selectAll("circle,image,rect").data(this.data,function(a){return a.id})},calculate_x:function(a){"use strict";return(a-this.window.start)*this.scale_x+this.translate_offset},translate_x:function(a){"use strict";console.log("translate");var b=a.data;this.translate_offset+=b*this.scale_x,this.svg_gp.attr("transform","translate("+-this.translate_offset+",0)")},addbrush:function(){"use strict";var a={top:200,right:40,bottom:200,left:40},b=500-a.top-a.bottom,c=f.time.scale().domain([this.window.start,this.window.end]).range([0,this.element.clientWidth]),d=function(){var a=g.brushP.extent();g.windowZoom.set_start(new Date(a[0]).getTime()),g.windowZoom.set_end(new Date(a[1]).getTime())},e=f.svg.brush().x(c).on("brushend",d);this.brushP=e,this.gBrush=this.svg.append("g").attr("class","brush").attr("id","brush").call(e).attr("width","1840"),this.gBrush.selectAll("rect").attr("height",b);var g=this},draw:function(a){"use strict";if(a)switch(a.type){case"trace:update":this.data=this.trace.list_obsels();break;default:this.data=this.trace.obsel_list}var b=this;this.d3Obsels().exit().remove(),this.d3Obsels().enter().append("image").attr("class","Samotraces-obsel").attr("x",this.options.x).attr("y",function(){return b.getValueAttributStyle(this.__data__.type,"y")}).attr("width",function(){return b.getValueAttributStyle(this.__data__.type,"width")}).attr("height",function(){return b.getValueAttributStyle(this.__data__.type,"height")}).attr("xlink:href",function(){return b.getValueAttributStyle(this.__data__.type,"icon")}),e("image",this.element).each(function(a,b){e.data(b,{"Samotraces-type":"obsel","Samotraces-data":f.select(b).datum()})})},refresh_x:function(){"use strict";this.scale_x=this.element.clientWidth/this.window.get_width(),this.translate_offset=0,this.svg_gp.attr("transform","translate(0,0)");var a=this;this.d3Obsels().attr("x",this.options.x).attr("y",function(){return a.getValueAttributStyle(this.__data__.type,"y")});var b=this.element.getElementsByClassName("brush");b[0].parentNode.removeChild(b[0]),this.addbrush()}},b.exports=g},{"./Widget.js":18,d3:"d3",jquery:"jquery"}],14:[function(a,b,c){var d=a("./Widget.js"),e=a("jquery"),f=a("d3"),g=function(a,b,c,e){e=e||{},d.call(this,a),this.add_class("Widget-TraceDisplayIcons"),this.trace=b,this.trace.on("trace:update",this.draw.bind(this)),this.trace.on("trace:create_obsel",this.draw.bind(this)),this.window=c,this.window.on("tw:update",this.refresh_x.bind(this)),this.init_DOM(),this.data=this.trace.obsel_list;var f=this,g=function(a){return a instanceof Function?a.bind(f):a};this.options={},this.options.x=g(e.x||function(a){return this.calculate_x(a.get_begin())-8}),this.stylesheet=e,this.draw()};g.prototype={init_DOM:function(){var a=f.select(this.element);this.svg=a.append("svg"),"undefined"!=typeof this.window.timer&&this.svg.append("line").attr("x1","50%").attr("y1","0%").attr("x2","50%").attr("y2","100%").attr("stroke-width","1px").attr("stroke","red").attr("opacity","0.3"),this.scale_x=this.element.clientWidth/this.window.get_width(),this.translate_offset=0;var b=(f.time.scale().domain([this.window.start,this.window.end]).range([0,this.element.clientWidth]),{top:200,right:40,bottom:200,left:40});500-b.top-b.bottom;this.svg_gp=this.svg.append("g").attr("transform","translate(0,0)"),this.svg_selected_obsel=this.svg.append("line").attr("x1","0").attr("y1","0%").attr("x2","0").attr("y2","100%").attr("stroke-width","1px").attr("stroke","black").attr("opacity","0.3").attr("transform","translate(0,0)").style("display","none")},d3Obsels:function(){return this.svg_gp.selectAll("circle,image,rect").data(this.data,function(a){return a.id})},calculate_x:function(a){var b=(a-this.window.start)*this.scale_x+this.translate_offset;return b},draw:function(a){if(a)switch(a.type){case"trace:update":this.data=this.trace.list_obsels();break;default:this.data=this.trace.obsel_list}var b=this;this.d3Obsels().exit().remove(),this.d3Obsels().enter().append("image").attr("class","Samotraces-obsel").attr("x",this.options.x).attr("y",function(){return b.getValueAttributStyle(this.__data__.type,"y")}).attr("width",function(){return b.getValueAttributStyle(this.__data__.type,"width")}).attr("height",function(){return b.getValueAttributStyle(this.__data__.type,"height")}).attr("xlink:href",function(){return b.getValueAttributStyle(this.__data__.type,"icon")}),e("image",this.element).each(function(a,b){e.data(b,{"Samotraces-type":"obsel","Samotraces-data":f.select(b).datum()})})},refresh_x:function(){this.scale_x=this.element.clientWidth/this.window.get_width(),this.translate_offset=0,this.svg_gp.attr("transform","translate(0,0)");var a=this;this.d3Obsels().attr("x",this.options.x).attr("y",function(){return a.getValueAttributStyle(this.__data__.type,"y")})}},b.exports=g},{"./Widget.js":18,d3:"d3",jquery:"jquery"}],15:[function(a,b,c){var d=a("./Widget.js"),e=a("jquery"),f=a("d3"),g=function(a,b,c){d.call(this,a),this.add_class("Widget-ObselOccurrences"),e(window).resize(this.refresh_x.bind(this)),this.trace=b,this.trace.on("trace:update",this.draw.bind(this)),this.trace.on("trace:create_obsel",this.draw.bind(this)),this.trace.on("trace:remove_obsel",this.draw.bind(this)),this.trace.on("trace:edit_obsel",this.obsel_redraw.bind(this)),this.window=c,this.window.on("tw:update",this.refresh_x.bind(this)),this.window.on("tw:translate",this.translate_x.bind(this)),this.init_DOM(),this.data=this.trace.list_obsels();this.draw()};g.prototype={init_DOM:function(){var a=f.select("#"+this.id);this.svg=a.append("svg").attr("xmlns","http://www.w3.org/2000/svg").attr("version","1.1"),this.scale_x=this.element.clientWidth/this.window.get_width(),this.translate_offset=0,this.svg_gp=this.svg.append("g").attr("transform","translate(0,0)");var b=this;this.add_behaviour("changeTimeOnDrag",this.element,{onUpCallback:function(a){var c=-a*b.window.get_width()/b.element.clientWidth;b.svg_gp.attr("transform","translate("+-b.translate_offset+",0)"),b.window.translate(c)},onMoveCallback:function(a){b.svg_gp.attr("transform","translate("+(a-b.translate_offset)+",0)")}}),this.add_behaviour("zommOnScroll",this.element,{timeWindow:this.window})},calculate_x:function(a){var b=(a.get_begin()-this.window.start)*this.scale_x+this.translate_offset;return b},calculate_width:function(a){var b=Math.max(.01,(a.get_end()-a.get_begin())*this.scale_x);return b},translate_x:function(a){var b=a.data;this.translate_offset+=b*this.scale_x,this.svg_gp.attr("transform","translate("+-this.translate_offset+",0)")},refresh_x:function(){this.scale_x=this.element.clientWidth/this.window.get_width(),this.translate_offset=0,this.svg_gp.attr("transform","translate(0,0)"),this.d3Obsels().attr("x",this.calculate_x.bind(this)).attr("width",this.calculate_width.bind(this))},draw:function(a){if(a)switch(a.type){case"trace:update":this.data=this.trace.list_obsels();break;default:this.data=this.trace.obsel_list}this.d3Obsels().exit().remove(),this.d3Obsels().enter().append("rect").attr("x",this.calculate_x.bind(this)).attr("y","0").attr("width",this.calculate_width.bind(this)).attr("height","20"),e("rect",this.element).each(function(a,b){e.data(b,{"Samotraces-type":"obsel","Samotraces-data":f.select(b).datum()})})},obsel_redraw:function(a){var b=a.data;this.d3Obsels().filter(function(a){return a.get_id()==b.get_id()}).datum(b).attr("x",this.calculate_x.bind(this)).attr("width",this.calculate_width.bind(this)).attr("xlink:href",this.options.url)},d3Obsels:function(){return this.svg_gp.selectAll("circle,image,rect").data(this.data,function(a){return a.id})}},b.exports=g},{"./Widget.js":18,d3:"d3",jquery:"jquery"}],16:[function(a,b,c){var d=a("./Widget.js"),e=a("jquery"),f=function(a,b,c){"use strict";d.call(this,a),this.divId=a,this.add_class("Widget-TraceDisplayText"),this.trace=b,this.trace.on("trace:updateT",this.refreshX.bind(this)),this.trace.on("trace:create_obsel_Text",this.draw.bind(this)),this.window=c,this.window.on("tw:update",this.refreshX.bind(this)),this.window.on("ChangeLangage",this.refreshX.bind(this)),this.refreshX(),this.dataOb=[]};f.prototype={draw:function(a){"use strict";this.dataOb.push(JSON.stringify(a.data)),e("#"+a.data["@id"]).hide()},refreshX:function(){"use strict";var a=this.window;this.trace.obsel_list.forEach(function(b){a.start<=b.get_begin()&&b.get_begin()<=a.end?e("#"+b.get_id()).show():e("#"+b.get_id()).hide()})},redraw:function(){"use strict";document.getElementById(this.divId).innerHTML="",this.dataOb.forEach(function(a){e("#"+JSON.parse(a)["@id"]).hide()}),this.refreshX()}},b.exports=f},{"./Widget.js":18,jquery:"jquery"}],17:[function(a,b,c){var d=a("./Widget.js"),e=a("jquery"),f=a("d3"),g=function(a,b,c,f,g,h){d.call(this,a),this.mode="window_sync",(void 0!==g||void 0!==h)&&(this.mode="obsel_sync",void 0!==g&&g.hasOwnProperty("x")&&(this.x1=g.x.bind(this)),void 0!==h&&h.hasOwnProperty("x")&&(this.x2=h.x.bind(this))),this.add_class("Widget-ObselOccurrences"),e(window).resize(this.refresh_x.bind(this)),this.trace=b,this.trace.on("trace:update",this.draw.bind(this)),this.trace.on("trace:create_obsel",this.draw.bind(this)),this.trace.on("trace:remove_obsel",this.draw.bind(this)),this.trace.on("trace:edit_obsel",this.obsel_redraw.bind(this)),this.window1=c,this.window1.on("tw:update",this.refresh_x.bind(this)),this.window1.on("tw:translate",this.refresh_x.bind(this)),this.window2=f,this.window2.on("tw:update",this.refresh_x.bind(this)),this.window2.on("tw:translate",this.refresh_x.bind(this)),this.init_DOM(),this.data=this.trace.list_obsels();this.draw()};g.prototype={init_DOM:function(){var a=f.select("#"+this.id);this.svg=a.append("svg").attr("xmlns","http://www.w3.org/2000/svg").attr("version","1.1"),this.scale_x1=this.element.clientWidth/this.window1.get_width(),this.scale_x2=this.element.clientWidth/this.window2.get_width(),this.translate_offset=0,this.sync_path=this.svg.append("path").attr("style","stroke:grey;stroke-width:1px;fill:#ddd;"),this.svg_gp=this.svg.append("g").attr("transform","translate(0,0)")},calculate_x:function(a){var b=(a-this.w_start)*this.scale_x;return b},o2x1:function(a){return this.w_start=this.window1.start,this.scale_x=this.scale_x1,this.x1(a)},o2x2:function(a){return this.w_start=this.window2.start,this.scale_x=this.scale_x2,this.x2(a)},x1:function(a){return this.calculate_x(a.get_begin())},x2:function(a){return this.calculate_x(a.get_begin())},calculate_path:function(a){var b=[],c=this.o2x1(a),d=this.o2x2(a);return b=["M",c,"0","C",c,"10,",d,"10,",d,"20"],b.join(" ")},calculate_visibility:function(a){var b=this.o2x1(a);if(0>b)return!1;if(b>this.element.clientWidth)return!1;var c=this.o2x2(a);return c>this.element.clientWidth?!1:0>c?!1:!0},calculate_style:function(a){return this.calculate_visibility(a)?"stroke:grey;stroke-width:1px;fill:none;":"stroke:none;stroke-width:1px;fill:none;"},translate_x:function(a){var b=a.data;this.translate_offset+=b*this.scale_x,this.svg_gp.attr("transform","translate("+-this.translate_offset+",0)")},refresh_x:function(){this.scale_x1=this.element.clientWidth/this.window1.get_width(),this.scale_x2=this.element.clientWidth/this.window2.get_width(),this.translate_offset=0,this.svg_gp.attr("transform","translate(0,0)"),"obsel_sync"==this.mode?this.d3Obsels().attr("d",this.calculate_path.bind(this)).attr("style",this.calculate_style.bind(this)):this.sync_path.attr("d",this.calculate_sync_path.bind(this))},draw:function(a){if(a)switch(a.type){case"trace:update":this.data=this.trace.list_obsels();break;default:this.data=this.trace.obsel_list}"obsel_sync"==this.mode?(this.d3Obsels().exit().remove(),this.d3Obsels().enter().append("path").attr("d",this.calculate_path.bind(this)).attr("style",this.calculate_style.bind(this)),this.d3Obsels(),e("path",this.element).each(function(a,b){e.data(b,{"Samotraces-type":"obsel","Samotraces-data":f.select(b).datum()})})):this.sync_path.attr("d",this.calculate_sync_path.bind(this))},calculate_sync_path:function(){var a=Math.max(this.window1.start,this.window2.start),b=Math.min(this.window1.end,this.window2.end),c=(Math.min(a,this.window1.end)-this.window1.start)*this.scale_x1,d=(Math.min(a,this.window2.end)-this.window2.start)*this.scale_x2,e=(Math.max(b,this.window1.start)-this.window1.start)*this.scale_x1,f=(Math.max(b,this.window2.start)-this.window2.start)*this.scale_x2,g=["M",c,"0","C",c,"20,",d,"0,",d,"20","L",f,"20","C",f,"0,",e,"20,",e,"0","Z"];return g.join(" ")},obsel_redraw:function(a){var b=a.data;this.d3Obsels().filter(function(a){return a.get_id()==b.get_id()}).datum(b).attr("d",this.calculate_path.bind(this))},d3Obsels:function(){return this.svg_gp.selectAll("path").data(this.data,function(a){return a.id})}},b.exports=g},{"./Widget.js":18,d3:"d3",jquery:"jquery"}],18:[function(a,b,c){var d=a("jquery");a("jquery-mousewheel")(d);var e=function(){function a(a){this.element.className+=" "+a}function b(a,b){return this.stylesheet[a]&&this.stylesheet[a][b]&&""!==this.stylesheet[a][b]?this.stylesheet[a][b]:this.stylesheet["default"][b]}function c(a,b,c){switch(a){case"changeTimeOnDrag":var e,f,g,h;e=function(a){return h=a.clientX,b.addEventListener("mousemove",g),b.addEventListener("mouseup",f),b.addEventListener("mouseleave",f),!1},f=function(a){if(void 0!==h){var d=a.clientX-h;c.onUpCallback(d),b.removeEventListener("mousemove",g),b.removeEventListener("mouseup",f),b.removeEventListener("mouseleave",f)}return!1},g=function(a){var b=a.clientX-h;return c.onMoveCallback(b),!1},b.addEventListener("mousedown",e);break;case"zommOnScroll":var i;i=function(a){var b=Math.pow(.8,a.deltaY);return c.timeWindow.zoom(b),a.preventDefault(),!1},d(b).mousewheel(i)}}return function(d){return this.element=d,this.id=this.element.id,this.add_class=a,this.add_behaviour=c,this.add_class("Widget"),this.getValueAttributStyle=b,this}}();b.exports=e},{jquery:"jquery","jquery-mousewheel":"jquery-mousewheel"}],19:[function(a,b,c){var d=a("./Widget.js"),e=a("jquery"),f=a("d3"),g=function(a,b,c){"use strict";d.call(this,a),this.add_class("Widget-WindowScale"),e(window).resize(this.draw.bind(this)),this.window=b,this.window.on("tw:update",this.draw.bind(this)),this.window.on("tw:translate",this.draw.bind(this)),this.window.start>1e9?this.isJavascriptDate=c||!0:this.isJavascriptDate=c||!1,this.initDOM(),this.draw()};g.prototype={initDOM:function(){"use strict";this.svg=f.select(this.element).append("svg"),this.isJavascriptDate?this.x=f.time.scale():this.x=f.scale.linear(),this.xAxis=f.svg.axis().scale(this.x),this.x.domain([this.window.start,this.window.end]),this.svgAxis=this.svg.append("g"),this.add_behaviour("zommOnScroll",this.element,{timeWindow:this.window})},draw:function(){"use strict";this.x.range([0,this.element.clientWidth]),this.x.domain([this.window.start,this.window.end]),this.svgAxis.call(this.xAxis)}},b.exports=g},{"./Widget.js":18,d3:"d3",jquery:"jquery"}],20:[function(a,b,c){var d=a("./Widget.js"),e=a("jquery"),f=a("d3"),g=function(a,b,c){d.call(this,a),this.add_class("Widget-WindowScale"),e(window).resize(this.draw.bind(this)),this.window=b,this.window.start>1e9?this.is_javascript_date=c||!0:this.is_javascript_date=c||!1,this.window.on("tw:update",this.draw.bind(this)),this.init_DOM(),this.draw()};g.prototype={init_DOM:function(){this.svg=f.select(this.element).append("svg"),this.is_javascript_date?this.x=f.time.scale():this.x=f.scale.linear(),this.xAxis=f.svg.axis().scale(this.x),this.x.domain([this.window.start,this.window.end]),this.svgAxis=this.svg.append("g")},draw:function(){this.x.range([0,this.element.clientWidth]),this.x.domain([this.window.start,this.window.end]),this.svgAxis.call(this.xAxis)}},b.exports=g},{"./Widget.js":18,d3:"d3",jquery:"jquery"}],21:[function(a,b,c){var d=a("./Widget.js"),e=a("jquery"),f=function(a,b,c){d.call(this,a),this.add_class("Widget-WindowSlider"),e(window).resize(this.draw.bind(this)),this.wide_window=b,this.wide_window.on("tw:update",this.draw.bind(this)),this.wide_window.on("tw:translate",this.draw.bind(this)),this.slider_window=c,this.slider_window.on("tw:update",this.draw.bind(this)),this.slider_window.on("tw:translate",this.draw.bind(this)),this.slider_offset=0,this.width=0,this.init_DOM(),this.draw()};f.prototype={init_DOM:function(){this.slider_element=document.createElement("div"),this.element.appendChild(this.slider_element);var a=this;this.add_behaviour("changeTimeOnDrag",this.slider_element,{onUpCallback:function(b){var c=b*a.wide_window.get_width()/a.element.clientWidth;a.slider_window.translate(c)},onMoveCallback:function(b){a.slider_element.style.left=a.slider_offset+b+"px"}}),this.add_behaviour("zommOnScroll",this.element,{timeWindow:this.slider_window})},draw:function(){this.width=this.slider_window.get_width()/this.wide_window.get_width()*this.element.clientWidth,this.slider_offset=(this.slider_window.start-this.wide_window.start)*this.element.clientWidth/this.wide_window.get_width(),this.slider_element.style.display="block",this.slider_element.style.width=this.width+"px",this.slider_element.style.left=this.slider_offset+"px"}},b.exports=f},{"./Widget.js":18,jquery:"jquery"}],22:[function(a,b,c){var d=function(){function a(a,b){var c={type:a,data:b};this.callbacks[a]&&this.callbacks[a].map(function(a){a(c)})}function b(a,b){if("[object Function]"!=={}.toString.call(b))throw console.log(b),"Callback for event "+a+" is not a function";this.callbacks[a]=this.callbacks[a]||[],this.callbacks[a].push(b)}return function(c){function d(a){f(a.data)}this.callbacks=this.callbacks||{},this.trigger=a,this.on=b;for(var e in c)if(event.hasOwnProperty(e)){var f=c[e];this.on(e,d)}return this}}();b.exports=d},{}],23:[function(a,b,c){var d=a("./KTBS.Resource.js"),e=function(a,b){void 0===b&&(b=a),d.call(this,b,a,"Base",""),this.traces=[],this.models=[],this.force_state_refresh()};e.prototype={get:function(a){},list_traces:function(){return this.traces},list_models:function(){return this.models},create_stored_trace:function(a,b,c,d,e){var f={"@context":"http://liris.cnrs.fr/silex/2011/ktbs-jsonld-context","@type":"StoredTrace","@id":a+"/"};f.hasModel=void 0===b||null===b?"http://liris.cnrs.fr/silex/2011/simple-trace-model":b,f.origin=void 0===c||null===c?"1970-01-01T00:00:00Z":c,void 0===d&&(f.default_subject=d),void 0===e&&(f.label=e),$.ajax({url:this.uri,type:"POST",contentType:"application/json",data:JSON.stringify(f),success:this.force_state_refresh.bind(this),error:function(a,b,c){console.log("query error"),console.log([a,b,c])}})},create_model:function(a){var b={"@context":"http://liris.cnrs.fr/silex/2011/ktbs-jsonld-context","@graph":[{"@id":a,"@type":"TraceModel",inBase:"./",hasUnit:"millisecond"}]},c=JSON.stringify(b);$.ajax({url:this.uri,type:"POST",contentType:"application/json",data:c,success:this.force_state_refresh.bind(this),error:function(a,b,c){console.log("query error"),console.log([a,b,c])}})},create_computed_trace:function(a,b,c,d,e){},create_method:function(a,b,c,d){},_on_state_refresh_:function(a){this._check_change_("label",a["http://www.w3.org/2000/01/rdf-schema#label"],"base:update"),this._check_change_("traces",a.contains,"base:update")},get_trace:function(a){return new Samotraces.KTBS.Trace(this.uri+a+"/",a)}},b.exports=e},{"./KTBS.Resource.js":26}],24:[function(a,b,c){var d=a("./KTBS.Resource.js"),e=a("./EventHandler.js"),f=function(a,b){void 0===b&&(b=a),e.call(this),d.call(this,b,a,"Model",""),this.list_Types_Obsles=[],this.force_state_refresh()};f.prototype={_on_state_refresh_:function(a){this.get_etag();this.trigger("Model:get"),this.list_Types_Obsles=this.list_obsels(a["@graph"])},list_obsels:function(a){ListeObselType=[];var b=this;return a.forEach(function(a,c){var d={attributes:[]};"ObselType"==a["@type"]?(d.id=a["@id"],d.type=a["@id"].substr(1),d.coche=!1,a.hasSuperObselType&&(d.hasSuperObselType=a.hasSuperObselType),ListeObselType.push(d)):"AttributeType"==a["@type"]&&(d=b.GetObselType(a.hasAttributeObselType,ListeObselType),a.coche=!1,d.attributes.push(a))}),ListeObselType.forEach(function(a){a.hasSuperObselType&&(a.attributes=b.getAttributes(a.hasSuperObselType[0]))}),b.trigger("Model:listeType",ListeObselType),ListeObselType},GetObselType:function(a,b){return b.forEach(function(b){b.id==a&&(obsR=b)}),obsR},getAttributes:function(a){return ListeObselType.forEach(function(b){b.id===a&&(Att=b.attributes)}),Att},put_model:function(a){this.force_state_refresh();var b=this;return new Promise(function(c,d){b.on("Model:get",function(){var e=b.etag,f=new XMLHttpRequest;f.open("PUT",b.id,!0),f.setRequestHeader("Content-Type","application/json"),f.setRequestHeader("If-Match",e),f.onreadystatechange=function(){4===f.readyState&&(200===f.status?(console.log("OKOKOK"),c(new Samotraces.Ktbs.Model(b.id))):d(f))},f.onerror=function(){d(Error("There was a network error."))},f.send(a)})})}},b.exports=f},{"./EventHandler.js":22,"./KTBS.Resource.js":26}],25:[function(a,b,c){var d=a("./KTBS.Resource.js"),e=a("./Obsel.js"),f=function(a){d.call(this,a.id,a.uri,"Obsel",a.label||""),this._private_check_error(a,"trace"),this._private_check_error(a,"type"),this._private_check_default(a,"begin",Date.now()),this._private_check_default(a,"end",this.begin),this._private_check_default(a,"attributes",{}),this._private_check_undef(a,"relations",[]),this._private_check_undef(a,"inverse_relations",[]),this._private_check_undef(a,"source_obsels",[])};f.prototype=e.prototype,b.exports=f},{"./KTBS.Resource.js":26,"./Obsel.js":30}],26:[function(a,b,c){var d=(a("./EventHandler.js"),a("jquery")),e=function(){function a(){"use strict";return this.type}function b(a,b){var c=a.split("/"),d=b.split("/");c.pop();for(var e=0;e<d.length;e++)"."!=d[e]&&(".."==d[e]?c.pop():c.push(d[e]));return c.join("/")}function c(){return this.id}function e(){return this.uri.replace("./","")}function f(){return this.etag}function g(a,b,c){b=b||function(){},c=c||function(){},a=a||{_on_state_refresh_:!0};var e=this.uri,f=this;d.ajax({url:e,type:"GET",dataType:"json",xhrFields:{withCredentials:!0},error:function(a,b,d){if("401"===a.status){console.log(a.getAllResponseHeaders());for(var e=a.getResponseHeader("Link"),f=e.split(","),g=0;g<f.length;g++){var h,i,j=f[g].split(";");" rel=oauth_resource_server"===j[1]&&(h=j[0].substr(1,j[0].length-2))," rel=successful_login_redirect"===j[1]&&(i=j[0].substr(2,j[0].length-3))}window.open(h)}c(a)},success:function(c,d,e){f.etag=e.getResponseHeader("ETag"),b(c),a._on_state_refresh_&&f._on_state_refresh_(c)}})}function h(a){this.auto_refresh_id?this.stop_auto_refresh():null;this.auto_refresh_id=window.setInterval(this.force_state_refresh.bind(this),1e3*a)}function i(){this.auto_refresh_id&&(window.clearInterval(this.auto_refresh_id),delete this.auto_refresh_id)}function j(){}function k(){function a(){}d.ajax({url:this.uri,type:"DELETE",success:a.bind(this),error:function(a,b,c){throw"Cannot delete "+this.get_resource_type()+" "+this.uri+": "+b+" "+JSON.stringify(c)}})}function l(){return this.label}function m(){}function n(){}function o(a,b,c){void 0!==b&&this[a]!==b&&(this[a]=b,this.trigger(c))}return function(d,p,q,r){return Samotraces.EventHandler.call(this),this.id=d,this.uri=p,this.label=r,this.type=q,this.get_id=c,this.get_uri=e,this.force_state_refresh=g,this.get_read_only=j,this.remove=k,this.get_label=l,this.set_label=m,this.reset_label=n,this.get_etag=f,this.get_resource_type=a,this._check_change_=o,this.start_auto_refresh=h,this.stop_auto_refresh=i,this.getAbsoluteURLFromRlative=b,this}}();b.exports=e},{"./EventHandler.js":22,jquery:"jquery"}],27:[function(a,b,c){var d=a("./KTBS.Resource.js"),e=a("./KTBS.Obsel.js"),f=a("jquery"),g=function(a,b){"use strict";void 0===b&&(b=a),d.call(this,b,a,"Base",""),this.temp={},this.default_subject="",this.model_uri="",this.obsel_list_uri=a+"@obsels",this.base_uri="",this.origin="",this.obsel_list=[],this.traceSet=[],this.force_state_refresh()};g.prototype={get_base:function(){"use strict";return this.getAbsoluteURLFromRlative(this.get_uri(),this.base_uri)},get_model:function(){"use strict";return this.getAbsoluteURLFromRlative(this.get_uri(),this.model_uri)},get_origin:function(){"use strict";return this.origin},list_source_traces:function(){},list_transformed_traces:function(){},list_obsels:function(a,b,c){"use strict";if(this.obsel_list_uri=this.uri+"@obsels",""===this.obsel_list_uri)return console.log("Error in KTBS:Trace:list_obsels() unknown uri"),!1;var d=this,d=this;return f.ajax({url:this.obsel_list_uri,type:"GET",dataType:"json",data:{minb:a,maxb:b,reverse:c},xhrFields:{withCredentials:!0},error:function(a){if("401"===a.status){for(var b=a.getResponseHeader("Link"),c=b.split(","),d=0;d<c.length;d++){var e=c[d].split(";");if(" rel=oauth_resource_server"===e[1])var f=e[0].substr(1,e[0].length-2);" rel=successful_login_redirect"===e[1]}window.open(f)}},success:function(a){a.obsels.length>0&&d.Before_on_refresh_obsel_list_(a)}}),this.obsel_list.filter(function(c){return b&&c.get_begin()>b?!1:a&&c.get_end()<a?!1:!0})},Before_on_refresh_obsel_list_:function(a){"use strict";this.trigger("trace:Config",a);var b=0,c=Number(b)+Number(100);a.obsels?this._on_refresh_obsel_list_group(a.obsels,b,c):this._on_refresh_obsel_list_group(a,b,c)},_on_refresh_obsel_list_group:function(a,b,c){"use strict";var d=a.length,e=a.slice(b,c);console.log("_on_refresh_obsel_list_group");for(var f=0;f<e.length;f++)if(this._parse_get_obsel_(e[f]),f===e.length-1){this.trigger("trace:updateT");var b=Number(b)+e.length+Number(1),c=Number(b)+Number(100)>d?a.length:Number(b)+Number(100);d>=b?this._on_refresh_obsel_list_group(a,b,c):this.trigger("trace:updateCompleted")}},_on_refresh_obsel_list_:function(a){"use strict";var b=0;a.forEach(function(c){b++,this._parse_get_obsel_(c),b===a.length&&this.trigger("trace:updateT",this)},this)},get_Last_obsel:function(){"use strict";var a,b=0;return this.obsel_list.forEach(function(c){c.get_begin()>b&&(a=c)}),a},get_First_obsel:function(){"use strict";var a,b=9999999999999;return this.obsel_list.forEach(function(c){c.get_begin()<b&&(a=c)}),a},get_List_obsel_ParType:function(a){"use strict";var b=[];return this.obsel_list.forEach(function(c){c.type===a&&b.push(c)}),b},start_auto_refresh_obsel_list:function(a){"use strict";this.auto_refresh_obsel_list_id?this.stop_auto_refresh_obsel_list():null;this.auto_refresh_obsel_list_id=window.setInterval(this.list_obsels.bind(this),1e3*a)},stop_auto_refresh_obsel_list:function(){"use strict";this.auto_refresh_obsel_list_id&&(window.clearInterval(this.auto_refresh_id),delete this.auto_refresh_id)},get_obsel:function(a){"use strict";var b;return this.obsel_list.forEach(function(c){c.get_id()===a&&(b=c)}),void 0===b&&jQuery.ajax({url:this.uri+a,dataType:"json",type:"GET",success:this._parse_get_obsel_.bind(this)}),b},_parse_get_obsel_:function(a,b,c){"use strict";var d={attributes:{}};d.id=a["@id"],"ComputedTrace"===this.type&&(d.id=d.type+"_"+d.id),"./"===d.id.substr(0,2)&&(d.id=d.id.substr(2)),d.trace=this,d.type=a["@type"].substr(2),a.hasOwnProperty("http://www.w3.org/2000/01/rdf-schema#label")&&(d.label=a["http://www.w3.org/2000/01/rdf-schema#label"]);var f=new Date(this.origin);d.begin=f.getTime()+a.begin,d.end=f.getTime()+a.end,delete a["@id"],delete a.hasTrace,delete a["@type"],delete a.begin,delete a.end,delete a["http://www.w3.org/2000/01/rdf-schema#label"];for(var g in a)"m:"===g.substr(0,2)&&(d.attributes[g.substr(2)]=a[g]);var h=new e(d);this._check_obsel_loaded_(h)||this.trigger("trace:create_obsel",h)},_on_state_refresh_:function(a){"use strict";this._check_and_update_trace_type_(a["@type"]),this._check_change_("default_subject",a.hasDefaultSubject,""),this._check_change_("model_uri",a.hasModel,"trace:model"),this._check_change_("obsel_list_uri",a.hasObselList,"trace:update"),this._check_change_("base_uri",a.inBase,"trace:base"),this._check_change_("origin",a.origin,"trace:update"),this._check_change_("label",a.label,"trace:update"),this.trigger("trace:updateData",a)},_update_method_:function(a,b){"use strict";this[b]=this[a+"_methods"][b],void 0!==this.temp[b]&&this.temp[b].forEach(function(a){this[b](a)},this)},_check_and_update_trace_type_:function(a){"use strict";if(this.type!==a){for(var b in this[a+"_methods"])this[a+"_methods"].hasOwnProperty(b)&&this._update_method_(a,b);this.type=a}},_check_obsel_loaded_:function(a){"use strict";return this.obsel_list.some(function(b){return b.get_id()===a.get_id()})?!0:(this.obsel_list.push(a),!1)},StoredTrace_methods:{set_model:function(a){},set_origin:function(a){"use strict";this.origin=a},get_default_subject:function(){"use strict";return this.default_subject},set_default_subject:function(a){},create_obsel:function(a){"use strict";function b(b,c,d){var f=b.split("/"),g=f[f.length-1];a.id=g,a.trace=this;var h=new e(a);this._check_obsel_loaded_(h)||this.trigger("trace:create_obsel",h)}var c={"@context":["http://liris.cnrs.fr/silex/2011/ktbs-jsonld-context",{m:"http://liris.cnrs.fr/silex/2011/simple-trace-model#"}],"@type":"m:"+a.type,hasTrace:"",subject:a.hasOwnProperty("subject")?a.subject:this.get_default_subject()};if(a.hasOwnProperty("begin")&&(c.begin=a.begin),a.hasOwnProperty("end")&&(c.begin=a.end),a.hasOwnProperty("attributes"))for(var d in a.attributes)a.attributes.hasOwnProperty(d)&&(c["m:"+d]=a.attributes[d]);f.ajax({url:this.uri,type:"POST",contentType:"application/json",success:b.bind(this),data:JSON.stringify(c)})}},ComputedTrace_methods:{set_method:function(a){},list_parameters:function(a){},get_parameter:function(a){},set_parameter:function(a,b){},del_parameter:function(a){}},create_obsel:function(a){"use strict";this.create_obsel.hasOwnProperty("create_obsel")||(this.temp.create_obsel=[]),this.temp.create_obsel.push(a)}},b.exports=g},{"./KTBS.Obsel.js":25,"./KTBS.Resource.js":26,jquery:"jquery"}],28:[function(a,b,c){var d=a("./KTBS.Resource.js"),e=a("./KTBS.Base.js"),f=a("jquery"),g=function(a){"use strict";d.call(this,a,a,"KTBS",""),this.bases=[],this.builtin_methods=[],this.force_state_refresh()};g.prototype={list_builtin_methods:function(){},get_builtin_method:function(){},list_bases:function(){"use strict";return this.bases},get_base:function(a){"use strict";return new e(this.uri+a,a)},create_base:function(a,b){"use strict";var c={"@context":"http://liris.cnrs.fr/silex/2011/ktbs-jsonld-context","@type":"Base","@id":a+"/",label:b};f.ajax({url:this.uri,type:"POST",contentType:"application/json",data:JSON.stringify(c),success:this.force_state_refresh.bind(this),error:function(a,b,c){console.log("query error"),console.log([a,b,c])}})},_on_state_refresh_:function(a){"use strict";this._check_change_("bases",a.hasBase,"ktbs:update"),
this._check_change_("builtin_methods",a.hasBuildinMethod,"ktbs:update")}},b.exports=g},{"./KTBS.Base.js":23,"./KTBS.Resource.js":26,jquery:"jquery"}],29:[function(a,b,c){var d=a("./Obsel.js"),e=a("./EventHandler.js"),f=function(a){"use strict";e.call(this),this.count=0,this.obsel_list=[],this.source_traces=void 0!==a?a:[],this.source_traces.forEach(function(a){a.transformed_traces.push(this)}),this.transformed_traces=[],this.origin=""};f.prototype={get_label:function(){"use strict";return this.label},set_label:function(a){"use strict";this.label=a,this.trigger("trace:edit_meta")},reset_label:function(){"use strict";this.label="",this.trigger("trace:edit_meta")},get_model:function(){"use strict";return this.model},get_origin:function(){"use strict";return this.origin},list_source_traces:function(){"use strict";return this.source_traces},list_transformed_traces:function(){"use strict";return this.transformed_traces},list_obsels:function(a,b){"use strict";return this.obsel_list.filter(function(c){return b&&c.get_begin()>b?!1:a&&c.get_end()<a?!1:!0})},get_obsel:function(a){"use strict";var b;return this.obsel_list.forEach(function(c){c.get_id()===a&&(b=c)}),b},set_model:function(a){"use strict";this.model=a,this.trigger("trace:edit_meta")},set_origin:function(a){"use strict";this.origin=a,this.trigger("trace:edit_meta")},get_default_subject:function(){"use strict";return this.subject},set_default_subject:function(a){"use strict";this.subject=a,this.trigger("trace:edit_meta")},create_obsel:function(a){"use strict";a.id=this.count,this.count++,a.trace=this;var b=new d(a);this.obsel_list.push(b),this.trigger("trace:create_obsel",b)},remove_obsel:function(a){"use strict";this.obsel_list=this.obsel_list.filter(function(b){return b===a?!1:!0}),this.trigger("trace:remove_obsel",a)},transform:function(a,b){"use strict";return a(this,b)},transformations:{duplicate:function(a){"use strict";var b=new f([a]);return a.list_obsels().forEach(function(a){b.create_obsel(a.to_Object())}),a.on("trace:create_obsel",function(a){var c=a.data;b.create_obsel(c.to_Object())}),b},filter_obsel_type:function(a,b){"use strict";var c=new f([a]);return a.list_obsels().forEach(function(a){b.types.some(function(b){return b===a.get_obsel_type()})?"keep"===b.mode&&c.create_obsel(a.to_Object()):"remove"===b.mode&&c.create_obsel(a.to_Object())}),a.on("trace:create_obsel",function(a){var d=a.data;b.types.some(function(a){return a===d.get_obsel_type()})?"keep"===b.mode&&c.create_obsel(d.to_Object()):"remove"===b.mode&&c.create_obsel(d.to_Object())}),c}}},b.exports=f},{"./EventHandler.js":22,"./Obsel.js":30}],30:[function(a,b,c){var d=a("jquery"),e=function(a){"use strict";this._private_check_error(a,"id"),this._private_check_error(a,"trace"),this._private_check_error(a,"type"),this._private_check_default(a,"begin",Date.now()),this._private_check_default(a,"end",this.begin),this._private_check_default(a,"attributes",{}),this._private_check_undef(a,"relations",[]),this._private_check_undef(a,"inverse_relations",[]),this._private_check_undef(a,"source_obsels",[]),this._private_check_undef(a,"label","")};e.prototype={attributes:{},relations:[],inverse_relations:[],source_obsels:[],label:"",_private_check_default:function(a,b,c){"use strict";this[b]=void 0!==a[b]?a[b]:c},_private_check_undef:function(a,b){"use strict";void 0!==a[b]&&(this[b]=a[b])},_private_check_error:function(a,b){"use strict";if(void 0===a[b])throw"Parameter "+b+" required.";this[b]=a[b]},remove:function(){"use strict";this.get_trace().remove_obsel(this)},get_id:function(){"use strict";return this.id},get_label:function(){"use strict";return this.label},set_label:function(a){"use strict";this.label=a},reset_label:function(){"use strict";this.label=""},get_trace:function(){"use strict";return this.trace},get_type:function(){"use strict";return this.type},get_begin:function(){"use strict";return this.begin},get_end:function(){"use strict";return this.end},force_set_obsel_type:function(a){"use strict";this.type=a,this.trace.trigger("trace:edit_obsel",this)},force_set_begin:function(a){"use strict";this.begin=a,this.trace.trigger("trace:edit_obsel",this)},force_set_end:function(a){"use strict";this.end=a,this.trace.trigger("trace:edit_obsel",this)},list_source_obsels:function(){"use strict";return void 0===this.list_source_obsels?[]:this.source_obsels},list_attribute_types:function(){"use strict";if(void 0===this.attributes)return[];var a=[];for(var b in this.attributes)this.attributes.hasOwnProperty(b)&&a.push(b);return a},list_relation_types:function(){"use strict";if(void 0===this.relations)return[];var a=[];return this.relations.forEach(function(b){-1===d.inArray(b.type,a)&&a.push(b.type)}),a},list_related_obsels:function(a){"use strict";var b=[];return void 0!==this.relations&&this.relations.forEach(function(c){c.type===a&&b.push(c.obsel_to)}),void 0!==this.inverse_relations&&this.inverse_relations.forEach(function(c){c.type===a&&b.push(c.obsel_to)}),b},list_inverse_relation_types:function(){"use strict";if(void 0===this.inverse_relations)return[];var a=[];return this.inverse_relations.forEach(function(b){-1===d.inArray(b.type,a)&&a.push(b.type)}),a},get_attribute:function(a){"use strict";if(void 0===this.attributes[a])throw"Attribute "+a+" is not defined";return this.attributes[a]},set_attribute:function(a,b){"use strict";this.attributes[a]=b,this.trace.trigger("trace:edit_obsel",this)},del_attribute:function(a){"use strict";delete this.attributes[a],this.trace.trigger("trace:edit_obsel",this)},add_related_obsel:function(a,b){"use strict";throw"method not implemented yet"},del_related_obsel:function(a,b){"use strict";throw"method not implemented yet"},to_Object:function(){"use strict";var a={id:this.id,type:this.type,begin:this.begin,end:this.end,attributes:{},relations:this.relations.slice(),inverse_relations:this.inverse_relations.slice(),source_obsels:this.source_obsels.slice(),label:this.label};for(var b in this.attributes)this.attributes.hasOwnProperty(b)&&(a.attributes[b]=this.attributes[b]);return a}},b.exports=e},{jquery:"jquery"}],31:[function(a,b,c){var d=a("./EventHandler.js"),e=function(a,b,c){"use strict";d.call(this,c),this.mode=b||"single",this.type=a,this.selection=[]};e.prototype={select:function(a){"use strict";"multiple"===this.mode?this.selection.push(a):this.selection=[a],this.trigger("selection:add",a)},empty:function(){"use strict";this.selection=[],this.trigger("selection:empty")},is_empty:function(){"use strict";return 0===this.selection.length},get_selection:function(){"use strict";return this.selection},unselect:function(a){"use strict";if("multiple"===this.mode){var b=!1;if(this.selection=this.selection.filter(function(c){return c===a?(b=!0,!1):!0}),!b)return!1}else this.selection=[];return this.trigger("selection:remove",a),!0},toggle:function(a){"use strict";"multiple"===this.mode?this.unselect(a)||this.select(a):0===this.selection.length||this.selection[0]!==a?this.select(a):this.unselect(a)}},b.exports=e},{"./EventHandler.js":22}],32:[function(a,b,c){var d=a("./EventHandler.js"),e=function(a){"use strict";if(d.call(this),void 0!==a.start&&void 0!==a.end)this.start=a.start,this.end=a.end,this.__calculate_width();else{if(void 0===a.timer||void 0===a.width)throw"Samotraces.TimeWindow error. Arguments could not be parsed.";this.set_width(a.width,a.timer.time),this.timer=a.timer,this.timer.on("timer:update",this._private_updateTime.bind(this)),this.timer.on("timer:play:update",this._private_updateTime.bind(this))}};e.prototype={__calculate_width:function(){"use strict";this.width=this.end-this.start},_private_updateTime:function(a){"use strict";var b=a.data,c=b-(this.start+this.width/2);this.start=b-this.width/2,this.end=b+this.width/2,this.trigger("tw:translate",c)},set_start:function(a){"use strict";this.start!==a&&(this.start=a,this.__calculate_width(),this.trigger("tw:update"))},set_end:function(a){"use strict";this.end!==a&&(this.end=a,this.__calculate_width(),this.trigger("tw:update"))},get_width:function(){"use strict";return this.width},set_width:function(a,b){"use strict";void 0===b&&(b=this.start+this.width/2),this.start=b-a/2,this.end=b+a/2,this.width=a,this.trigger("tw:update")},translate:function(a){"use strict";this.timer?this.timer.set(this.timer.time+a):(this.start=this.start+a,this.end=this.end+a,this.trigger("tw:translate",a))},zoom:function(a){"use strict";this.set_width(this.width*a)}},b.exports=e},{"./EventHandler.js":22}],33:[function(a,b,c){var d=a("./EventHandler.js"),e=function(a,b,c){"use strict";d.call(this),this.time=a||0,this.period=b||2e3,this.update_function=c||function(){return Date.now()},this.is_playing=!1};e.prototype={set_time:function(a){"use strict";var b=Number(a);this.time!==b&&(this.time=b,this.trigger("timer:update",this.time))},set:function(a){"use strict";return this.set_time(a)},get_time:function(){"use strict";return this.time},time:function(a){"use strict";if(!a)return this.time;var b=Number(a);this.time!==b&&(this.time=b,this.trigger("timer:update",this.time))},play:function(){"use strict";this.interval_id=window.setInterval(this.update_function.bind(this),this.period),this.is_playing=!0,this.trigger("timer:play",this.time)},pause:function(){"use strict";window.clearInterval(this.interval_id),this.is_playing=!1,this.trigger("timer:pause",this.time)}},b.exports=e},{"./EventHandler.js":22}],34:[function(a,b,c){var d=a("./core/EventHandler.js"),e=a("./core/KTBS.Resource.js"),f=a("./core/Obsel.js"),g=a("./core/TimeWindow.js"),h=a("./core/Timer.js"),i=a("./core/Selector.js"),j=a("./core/LocalTrace.js"),k=a("./core/KTBS.js"),l=a("./core/KTBS.Model.js"),m=a("./core/KTBS.Base.js"),n=a("./core/KTBS.Trace.js"),o=a("./UI/Widgets/ImportTrace.js"),p=a("./UI/Widgets/IntervalTimeForm.js"),q=a("./UI/Widgets/ListBases.js"),r=a("./UI/Widgets/ListModelInBases.js"),s=a("./UI/Widgets/ListTracesInBases.js"),t=a("./UI/Widgets/ObselInspector.js"),u=a("./UI/Widgets/ObselTypeInspector.js"),v=a("./UI/Widgets/ReadableTimeForm.js"),w=a("./UI/Widgets/TimeForm.js"),x=a("./UI/Widgets/TimeSlider.js"),y=a("./UI/Widgets/TraceDisplayIcons.js"),z=a("./UI/Widgets/TraceDisplayIconsFix.js"),A=a("./UI/Widgets/TraceDisplayIconsZoom.js"),B=a("./UI/Widgets/TraceDisplayObselOccurrences.js"),C=a("./UI/Widgets/TraceDisplayText.js"),D=a("./UI/Widgets/TraceDisplayZoomContext.js"),E=a("./UI/Widgets/DisplayModel.js"),F=a("./UI/Widgets/WindowScale.js"),G=a("./UI/Widgets/WindowScaleFix.js"),H=a("./UI/Widgets/WindowSlider.js"),I={Obsel:f,TimeWindow:g,Timer:h,Selector:i,EventHandler:d,LocalTrace:j,Ktbs:{Ktbs:k,Resource:e,Model:l,Base:m,Trace:n},Ui:{Widgets:{ImportTrace:o,IntervalTimeForm:p,ObselInspector:t,ObselTypeInspector:u,ReadableTimeForm:v,TimeForm:w,TimeSlider:x,TraceDisplayIcons:y,TraceDisplayIconsFix:z,TraceDisplayIconsZoom:A,TraceDisplayObselOccurrences:B,TraceDisplayText:C,TraceDisplayZoomContext:D,DisplayModel:E,WindowScale:F,WindowScaleFix:G,WindowSlider:H,Ktbs:{ListBases:q,ListModelInBases:r,ListTracesInBases:s}}}};b.exports=I},{"./UI/Widgets/DisplayModel.js":1,"./UI/Widgets/ImportTrace.js":2,"./UI/Widgets/IntervalTimeForm.js":3,"./UI/Widgets/ListBases.js":4,"./UI/Widgets/ListModelInBases.js":5,"./UI/Widgets/ListTracesInBases.js":6,"./UI/Widgets/ObselInspector.js":7,"./UI/Widgets/ObselTypeInspector.js":8,"./UI/Widgets/ReadableTimeForm.js":9,"./UI/Widgets/TimeForm.js":10,"./UI/Widgets/TimeSlider.js":11,"./UI/Widgets/TraceDisplayIcons.js":12,"./UI/Widgets/TraceDisplayIconsFix.js":13,"./UI/Widgets/TraceDisplayIconsZoom.js":14,"./UI/Widgets/TraceDisplayObselOccurrences.js":15,"./UI/Widgets/TraceDisplayText.js":16,"./UI/Widgets/TraceDisplayZoomContext.js":17,"./UI/Widgets/WindowScale.js":19,"./UI/Widgets/WindowScaleFix.js":20,"./UI/Widgets/WindowSlider.js":21,"./core/EventHandler.js":22,"./core/KTBS.Base.js":23,"./core/KTBS.Model.js":24,"./core/KTBS.Resource.js":26,"./core/KTBS.Trace.js":27,"./core/KTBS.js":28,"./core/LocalTrace.js":29,"./core/Obsel.js":30,"./core/Selector.js":31,"./core/TimeWindow.js":32,"./core/Timer.js":33}]},{},[34])(34)});