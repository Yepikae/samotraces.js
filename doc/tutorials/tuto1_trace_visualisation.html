<h1>Creating a trace visualisation in 20 minutes (?)</h1>

<h2>Introduction</h2>

<p>
This tutorial aims at learning how to visualise a trace
with Samotraces.js.
For this purpose, the first step consists in learning some
of the key concepts that are used in Samotraces.js and put 
these concepts into practice.
</p>

<h2>Key concepts</h2>

<p>
First, there are two types of objects that are necessary to
visualise a trace in Samotraces.js. There are Widgets, that 
will be displayed on the user's screen, and logical objects
that the Widgets will need to access to.
</p>

<h3>Widgets</h3>

<p>
Widgets are simple programs with a graphical user interface.
In this tutorial, for instance, we will use a widget for 
visualising a trace ({@link Samotraces.Widgets.d3Basic.TraceDisplayIcons} widget).
</p>

<p>
The widget that allows to visualise a trace needs of course 
to know what trace to visualise, and how to visualise it.
For instance, it needs to know what is the time frame that
you want to display, what is the current time, etc. For this
reason, the widget needs to be initialised with extra 
parameters: the trace the visualise, the relevant time frame,
the current time, etc.
</p>

<h3>Logical objects</h3>

<p>
The traces to visualise, the relevant time frame and the 
current time are not widgets. They are not directly displayed
on screen, but rather describes a logical behaviour. That is
why we call them logical objects.
</p>

<p>
Logical objects need to be initialised and will then be used
by different plugins. While it might not seem clear at this
point in the tutorial why there is a need for logical objets,
this will be clarified in further tutorials, when we will 
handle the development of more complex applications.
</p>

<p>
Now that we have described the context, let's go back to the
tutorial, and let's create our first trace visualisation...
</p>

<h2>First things first, the html code</h2>

<p>
The only requirement in your HTML code is to create a HTML
element that will contain the widget. The id of this HTML 
element will be used to properly initialise the widget. For 
instance, here, we create a <code>div</code> with the id 
<code>"my-widget"</code>.
</p>

<pre class="prettyprint"><code>&lt;!doctype html&gt;
&lt;html&gt;
	&lt;head&gt;
		&lt;meta charset="utf-8"&gt;
	&lt;/head&gt;
	&lt;body&gt;
		&lt;div id="my-widget"&gt;&lt;/div&gt;
	&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<p>
Now, extra files must be included.
First, you want to include Samotraces.js JavaScript code.
Then, for the purpose of this tutorial, the additional
JavaScript library d3.js must also be included, as it is
used by the trace visualisation widget.
Lastly, a CSS file will be included to offer a nicer display.
</p>

<p>
First, create two folders, one named "javascript", one named
"css". The "javascript" folder will contain the JavaScript files
(.js) and the "css" folder will contain the CSS files (.css).
Then download the relevant files and move them to the 
appropriate folder:
<ul>
	<li>Download <a href="../examples/tutorials/tuto1_trace_visualisation/javascript/Samotraces.js">Samotraces.js</a> and copy it in the "javascript" folder</li>
	<li>Download <a href="../examples/tutorials/tuto1_trace_visualisation/javascript/d3.js">d3.js</a> and copy it in the "javascript" folder</li>
	<li>Download <a href="../examples/tutorials/tuto1_trace_visualisation/css/samotraces.css">samotraces.css</a> and copy it in the "css" folder</li>
</ul>
Then, update the HTML code to link the files you have just 
downloaded.
The code should look like this now:
</p>

<pre class="prettyprint"><code>&lt;!doctype html&gt;
&lt;html&gt;
	&lt;head&gt;
		&lt;meta charset="utf-8"&gt;
		&lt;script type="text/javascript" src="javascript/d3.js"&gt;&lt;/script&gt;
		&lt;script type="text/javascript" src="javascript/Samotraces.js"&gt;&lt;/script&gt;
		&lt;link rel="stylesheet" type="text/css" href="css/samotraces.css"&gt; 
	&lt;/head&gt;
	&lt;body&gt;
		&lt;div id="my-widget"&gt;&lt;/div&gt;
	&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<h2>Javascript code</h2>

<p>
Now, lets use Samotraces.js to produce a trace visualisation.
We will focus now on the javascript code.
</p>

<p>
First, we want to create a trace visualisation. For this, we
will use the {@link Samotraces.Widgets.d3Basic.TraceDisplayIcons|TraceDisplayIcons} widget. If you have a look at the 
{@link Samotraces.Widgets.d3Basic.TraceDisplayIcons|TraceDisplayIcons} 
documentation, you will see that this widget needs to be 
initialised with 5 parameters:
<ol>
	<li>An HTML id</li>
	<li>A trace {@link Samotraces.Lib.DemoTrace|Trace}</li>
	<li>An obsel selector {@link Samotraces.Lib.ObselSelector|ObselSelector}</li>
	<li>A time window {@link Samotraces.Lib.TimeWindow|TimeWindow}</li>
	<li>Optional parameters for the visualisation</li>
</ol>
As the last parameter is optional, let's put it aside for 
the moment. In order to initialise the widget, we need to
write something like:
</p>

<pre class="prettyprint"><code>new Samotraces.Widgets.d3Basic.TraceDisplayIcons(id,trace,obsel_selector,time_window);
</code></pre>

<p>
Now, let's see how to initialise the parameters correctly.
</p>

<p>
The first parameter, the HTML id is the one that we have 
defined in the HTML source: <code>"my-widget"</code>. We
can replace it direcly:
</p>

<pre class="prettyprint"><code>new Samotraces.Widgets.d3Basic.TraceDisplayIcons('my-widget',trace,obsel_selector,time_window);
</code></pre>

<p>
Now, we will initialise the other 3 parameters: 
<code>trace</code>,
<code>obsel_selector</code>, and
<code>time_window</code> with the following code:
</p>

<pre class="prettyprint"><code>// Logical objects
var trace 		= new Samotraces.Lib.DemoTrace();
var obsel_selector	= new Samotraces.Lib.ObselSelector();
var tw			= new Samotraces.Lib.TimeWindow({start: 0,end: 20});
</code></pre>

<p>
Let's explain what this mean.
First, we initialise a trace, using the object 
{@link Samotraces.Lib.DemoTrace|DemoTrace}.
By doing this, we create a new (empty) trace.<br>
Then, we create an obsel selector. An obsel selector makes
it possible to know when an obsel has been selected or
unselected.<br>
Then, we create a {@link Samotraces.Lib.TimeWindow|TimeWindow}.
There are two ways to create a time window. In this tutorial,
we focus on the most simple way: defining the start and the
end of the time window.
Here, the time windows goes from 0 to 20.
</p>

<p>
In order for this script to be executed when the source code
of Samotraces.js has been successfully loaded in the web page,
you can wrap it in a function.
</p>

<pre class="prettyprint"><code>&lt;script type="text/javascript"&gt;
function init() {
	// Logical objects
	var trace 		= new Samotraces.Lib.DemoTrace();
	var obsel_selector	= new Samotraces.Lib.ObselSelector();
	var tw			= new Samotraces.Lib.TimeWindow({start: 0,end: 20});
	// Widgets
	new Samotraces.Widgets.d3Basic.TraceDisplayIcons('my-widget',trace,obsel_selector,tw);
}

// calling the init function when the DOM has been loaded
window.addEventListener('DOMContentLoaded', init );
&lt;/script&gt;
</code></pre>

<p>The full HTML code should look like this:</p>
<pre class="prettyprint"><code>&lt;!doctype html&gt;
&lt;html&gt;
	&lt;head&gt;
		&lt;meta charset="utf-8"&gt;
		&lt;script type="text/javascript" src="javascript/d3.js"&gt;&lt;/script&gt;
		&lt;script type="text/javascript" src="javascript/Samotraces.js"&gt;&lt;/script&gt;
		&lt;link rel="stylesheet" type="text/css" href="css/samotraces.css"&gt; 
	&lt;/head&gt;
	&lt;body&gt;
		&lt;div id="my-widget"&gt;&lt;/div&gt;
		&lt;script type="text/javascript"&gt;
		function init() {
			// Logical objects
			var trace 		= new Samotraces.Lib.DemoTrace();
			var obsel_selector	= new Samotraces.Lib.ObselSelector();
			var tw			= new Samotraces.Lib.TimeWindow({start: 0,end: 20});
			// Widgets
			new Samotraces.Widgets.d3Basic.TraceDisplayIcons('my-widget',trace,obsel_selector,tw);
		}

		// calling the init function when the DOM has been loaded
		window.addEventListener('DOMContentLoaded', init );
		&lt;/script&gt;
	&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<p>
Congratulations! Now, you are successfully visualising... 
an empty trace!
</p>

<p>
Let's add some objects in this trace. As can be seen in the
documentation of the {@link Samotraces.Lib.DemoTrace|DemoTrace}
object, adding a trace to an Obsel is quite easy. You simply
have to call the method <code>newObsel()</code> on the trace
object. This method takes 3 arguments:
<ol>
	<li>A String representing the type of the obsel</li>
	<li>A Number representing the time of the obsel</li>
	<li>Extra optional attributes related to this obsel</li>
</ol>
</p>

<p>
Now, we will create three new obsels.
We will imagine that the obsels represent what a user is 
doing on a web interface. Obsels will represents click events
made by the user at the times 1, 5 and 12.
This is done with the following code (that should be inserted
at the end of the <code>init()</code> function):
</p>

<pre class="prettyprint"><code>	trace.newObsel('click',1);
	trace.newObsel('click',5);
	trace.newObsel('click',12);
</code></pre>

<p>
Now, your source code should look as follows.
</p>

<pre class="prettyprint"><code>&lt;!doctype html&gt;
&lt;html&gt;
	&lt;head&gt;
		&lt;meta charset="utf-8"&gt;
		&lt;script type="text/javascript" src="javascript/d3.js"&gt;&lt;/script&gt;
		&lt;script type="text/javascript" src="javascript/Samotraces.js"&gt;&lt;/script&gt;
		&lt;link rel="stylesheet" type="text/css" href="css/samotraces.css"&gt; 
	&lt;/head&gt;
	&lt;body&gt;
		&lt;div id="my-widget"&gt;&lt;/div&gt;
		&lt;script type="text/javascript"&gt;
		function init() {
			// Logical objects
			var trace 		= new Samotraces.Lib.DemoTrace();
			var obsel_selector	= new Samotraces.Lib.ObselSelector();
			var tw			= new Samotraces.Lib.TimeWindow({start: 0,end: 20});
			// Widgets
			new Samotraces.Widgets.d3Basic.TraceDisplayIcons('my-widget',trace,obsel_selector,tw);

			trace.newObsel('click',1);
			trace.newObsel('click',5);
			trace.newObsel('click',12);
		}

// calling the init function when the DOM has been loaded
window.addEventListener('DOMContentLoaded', init );
		&lt;/script&gt;
	&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<p>
And you should be able to visualise something like this when
you load the HTML page on your web browser:
<img src="tutorials/tuto1_trace_visualisation_trace.png"></img>
You can try out the final result of this tutorial
<a href="../examples/tutorials/tuto1_trace_visualisation/index.html">here</a>.
</p>

<p>
Now, enjoy and play with the trace visualisation widget!
You can zoom in or out by scrolling vertically on the widget.
You can also move the time by clicking on the widget and
maintening the click while moving your pointer right or left.
</p>
